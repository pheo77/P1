<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#DC2626">
    <meta name="description" content="Hệ thống Phản ứng Khẩn cấp SOS - Truy cập nhanh dịch vụ khẩn cấp và chia sẻ vị trí">
    <title>Hệ thống Phản ứng Khẩn cấp SOS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-container">
                <div class="header-content">
                    <div class="logo">
                        <div class="logo-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                            </svg>
                        </div>
                        <h1>Phản ứng Khẩn cấp</h1>
                    </div>
                    
                    <!-- Desktop Navigation -->
                    <nav class="nav-desktop">
                        <button class="nav-tab active" data-tab="sos">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                            </svg>
                            <span>SOS</span>
                        </button>
                        <button class="nav-tab" data-tab="map">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                <circle cx="12" cy="10" r="3"/>
                            </svg>
                            <span>Bản đồ</span>
                        </button>
                        <button class="nav-tab" data-tab="dashboard">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="3" y1="6" x2="21" y2="6"/>
                                <line x1="3" y1="12" x2="21" y2="12"/>
                                <line x1="3" y1="18" x2="21" y2="18"/>
                            </svg>
                            <span>Bảng điều khiển</span>
                        </button>
                        <button class="nav-tab" data-tab="contacts">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                            </svg>
                            <span>Liên hệ</span>
                        </button>
                    </nav>

                    <!-- Mobile Menu Button -->
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="3" y1="6" x2="21" y2="6"/>
                            <line x1="3" y1="12" x2="21" y2="12"/>
                            <line x1="3" y1="18" x2="21" y2="18"/>
                        </svg>
                    </button>
                </div>

                <!-- Mobile Navigation -->
                <div class="nav-mobile" id="mobileNav">
                    <button class="nav-tab active" data-tab="sos">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                        </svg>
                        <span>SOS</span>
                    </button>
                    <button class="nav-tab" data-tab="map">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                            <circle cx="12" cy="10" r="3"/>
                        </svg>
                        <span>Bản đồ</span>
                    </button>
                    <button class="nav-tab" data-tab="dashboard">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="3" y1="6" x2="21" y2="6"/>
                            <line x1="3" y1="12" x2="21" y2="12"/>
                            <line x1="3" y1="18" x2="21" y2="18"/>
                        </svg>
                        <span>Bảng điều khiển</span>
                    </button>
                    <button class="nav-tab" data-tab="contacts">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                        </svg>
                        <span>Liên hệ</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- SOS Tab -->
            <div class="tab-content active" id="sos-tab">
                <div class="sos-container">
                    <div class="sos-content">
                        <div class="sos-header">
                            <h2>SOS Khẩn cấp</h2>
                            <p>Giữ nút trong 3 giây để kích hoạt dịch vụ khẩn cấp và thông báo cho danh bạ khẩn cấp của bạn</p>
                        </div>
                        
                        <div class="sos-button-container">
                            <button class="sos-button" id="sosButton">
                                <div class="sos-button-content">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                        <line x1="12" y1="9" x2="12" y2="13"/>
                                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                                    </svg>
                                    <span class="sos-text">SOS</span>
                                    <span class="countdown" id="countdown"></span>
                                </div>
                            </button>
                        </div>
                        
                        <div class="status-messages">
                            <div class="status-message hidden" id="countdownMessage">
                                <p>Giữ nút trong <span id="countdownSeconds">3</span> giây để kích hoạt khẩn cấp</p>
                            </div>
                            
                            <div class="status-message emergency-active hidden" id="emergencyActive">
                                <div class="status-icon">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                        <line x1="12" y1="9" x2="12" y2="13"/>
                                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                                    </svg>
                                </div>
                                <div>
                                    <span class="status-title">Khẩn cấp Đang hoạt động</span>
                                    <p>Vị trí của bạn đã được chia sẻ với dịch vụ khẩn cấp</p>
                                </div>
                            </div>

                            <div class="status-message location-error hidden" id="locationError">
                                <div class="status-icon">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                                        <circle cx="12" cy="10" r="3"/>
                                    </svg>
                                </div>
                                <div>
                                    <span class="status-title">Đang lấy vị trí...</span>
                                    <p>Vui lòng cho phép truy cập vị trí cho dịch vụ khẩn cấp</p>
                                    <button class="btn-primary" id="retryLocation">Thử lại vị trí</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Map Tab -->
            <div class="tab-content" id="map-tab">
                <div class="map-controls">
                    <button class="location-btn" id="locationBtn" title="Quay lại vị trí hiện tại">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                            <circle cx="12" cy="10" r="3"/>
                        </svg>
                    </button>
                </div>
                <div id="map" class="map-container"></div>
            </div>

            <!-- Dashboard Tab -->
            <div class="tab-content" id="dashboard-tab">
                <div class="dashboard-container">
                    <div class="dashboard-content">
                        <!-- Statistics Cards -->
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon red">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                        <line x1="12" y1="9" x2="12" y2="13"/>
                                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                                    </svg>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">Cảnh báo Đang hoạt động</p>
                                    <p class="stat-value red" id="activeAlerts">0</p>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-icon yellow">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                        <circle cx="9" cy="7" r="4"/>
                                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                    </svg>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">Đang phản ứng</p>
                                    <p class="stat-value yellow" id="respondingAlerts">0</p>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-icon green">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                                        <polyline points="22,4 12,14.01 9,11.01"/>
                                    </svg>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">Đã giải quyết</p>
                                    <p class="stat-value green" id="resolvedAlerts">0</p>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-icon blue">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                        <circle cx="9" cy="7" r="4"/>
                                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                    </svg>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">Đội có sẵn</p>
                                    <p class="stat-value blue" id="availableTeams">0</p>
                                </div>
                            </div>
                        </div>

                        <!-- Emergency Alerts List -->
                        <div class="emergency-card">
                            <div class="card-header">
                                <h2>Cảnh báo Khẩn cấp</h2>
                            </div>
                            <div class="alerts-list" id="alertsList">
                                <div class="empty-state">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                                        <line x1="12" y1="9" x2="12" y2="13"/>
                                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                                    </svg>
                                    <p>Không có cảnh báo khẩn cấp nào lúc này</p>
                                </div>
                            </div>
                        </div>

                        <!-- Rescue Teams Status -->
                        <div class="emergency-card">
                            <div class="card-header">
                                <h2>Đội Cứu hộ</h2>
                            </div>
                            <div class="teams-grid" id="teamsList">
                                <!-- Teams will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contacts Tab -->
            <div class="tab-content" id="contacts-tab">
                <div class="contacts-container">
                    <div class="contacts-content">
                        <div class="emergency-card">
                            <div class="card-header">
                                <div class="header-title">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                    </svg>
                                    <span>Liên hệ Khẩn cấp</span>
                                </div>
                                <button class="btn-primary" id="addContactBtn">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <line x1="12" y1="5" x2="12" y2="19"/>
                                        <line x1="5" y1="12" x2="19" y2="12"/>
                                    </svg>
                                    <span>Thêm liên hệ</span>
                                </button>
                            </div>

                            <!-- Quick Call Section -->
                            <div class="quick-call-section">
                                <h3>Dịch vụ Khẩn cấp</h3>
                                <div class="quick-call-grid">
                                    <button class="btn-danger quick-call-btn" onclick="callNumber('113')">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                        </svg>
                                        <span>113 - Công an</span>
                                    </button>
                                    <button class="btn-primary quick-call-btn" onclick="callNumber('114')">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                        </svg>
                                        <span>114 - Cứu hỏa</span>
                                    </button>
                                    <button class="btn-success quick-call-btn" onclick="callNumber('115')">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                        </svg>
                                        <span>115 - Y tế</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Contact Form -->
                            <div class="contact-form hidden" id="contactForm">
                                <form id="contactFormElement">
                                    <div class="form-grid">
                                        <div class="form-group">
                                            <label>Tên</label>
                                            <input type="text" name="name" class="form-input" required>
                                        </div>
                                        <div class="form-group">
                                            <label>Số điện thoại</label>
                                            <input type="tel" name="phone" class="form-input" required>
                                        </div>
                                        <div class="form-group">
                                            <label>Mối quan hệ</label>
                                            <select name="relationship" class="form-select" required>
                                                <option value="">Chọn mối quan hệ</option>
                                                <option value="Gia đình">Gia đình</option>
                                                <option value="Bạn bè">Bạn bè</option>
                                                <option value="Đồng nghiệp">Đồng nghiệp</option>
                                                <option value="Y tế">Y tế</option>
                                                <option value="Khác">Khác</option>
                                            </select>
                                        </div>
                                        <div class="form-group checkbox-group">
                                            <input type="checkbox" name="isPrimary" id="isPrimary">
                                            <label for="isPrimary">Liên hệ chính</label>
                                        </div>
                                    </div>
                                    <div class="form-actions">
                                        <button type="submit" class="btn-primary">
                                            <span id="formSubmitText">Thêm liên hệ</span>
                                        </button>
                                        <button type="button" class="btn-secondary" id="cancelFormBtn">Hủy</button>
                                    </div>
                                </form>
                            </div>

                            <!-- Contacts List -->
                            <div class="contacts-list" id="contactsList">
                                <div class="empty-state">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                                    </svg>
                                    <p>Chưa có liên hệ khẩn cấp nào</p>
                                    <p class="empty-subtitle">Thêm liên hệ để nhanh chóng liên lạc trong trường hợp khẩn cấp</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>
</html>